# 4 二元关系和函数

## 4.1 集合的笛卡儿积与二元关系

>   **定义 4.1**
>
>   由两个元素 x 和 y（允许 x = y）按一定顺序排列成的二元组称作一个**有序对**（或**序偶**），记作 $<x, y>$（或 $(x, y)$），其中 x 是第一元素，y 是第二元素。

平面直角坐标系中点的坐标就是有序对，如 $<0, 0>$、$<1, 0>$。

有序对具有以下特点：

1.   当 $x \ne y$ 时，$<x, y> \ne <y, x>$
2.   两个有序对相等，即 $<x, y> = <u, v>$ 的充要条件是 $(x = u) \and (y = v)$。

这些特点是集合 $\{x,y\}$ 不具备的。

>   **定义 4.2**
>
>   一个有序 n 元组（$n \ge 3$）是一个有序对，其中第一元素是一个有序 $n - 1$ 元组。一个有序 n 元组记作 $<x_1, x_2, \cdots, x_n>$，即：
>   $$
>   <x_1, x_2, \cdots, x_n> = <<x_1, x_2, \cdots, x_{n-1}>, x_n>
>   $$

在空间直角坐标系中点的坐标就是有序 3 元组，如 $<1, -1, 2>$。

在关系数据库中，数据按照表来组织，一个表多个列构成，如 $<书号, 书名, 作者, 出版社, 出版日期>$ 就是由 5 个列构成的书的记录，可以看作一个 5 元组，书的所有记录就构成了 5 元组的集合。

形式上 $<x>$ 也可看作有序 1 元组，但这里的顺序没有实际意义。

>   **定义 4.3**
>
>   设 A、B 为集合，用 A 中的元素为第一元素，B 中的元素为第二元素构成有序对，所有这样的有序对组成的集合称作 A 和 B 的**笛卡儿积**，记作 $A \times B$。
>
>   符号化为：
>   $$
>   A \times B = \{<x, y> \mid x \in A \and y \in B\}
>   $$

如 $A = \{a,b\}, B = \{c,d\}$，则：
$$
A \times B = \{<a,c>, <a,d>, <b,c>, <b,d>\} \\
B \times A = \{<c,a>, <d,a>, <c,b>, <d,b>\}
$$
若 $|A| = m, |B| = n$，则 $|A \times B| = |B \times A| = mn$。

由定义可知，若 $<x, y> \in A \times B$，则 $x \in A \and y \in B$；若 $<x, y> \notin A \times B$，则 $x \notin A \or y \notin B$。

笛卡儿积运算具有以下性质：

1.   若 A、B 中有一个空集，则笛卡儿积也是空集。

2.   当 $A \ne B$ 且都不是空集，有 $A \times B \ne B \times A$，因此**不满足交换律**

3.   当 A、B、C 都不是空集时，有 $(A \times B) \times C \ne A \times (B \times C)$，因此**不满足结合律**

4.   对 $\cup$ 和 $\cap$ 满足分配律：
     $$
     A \times (B \cup C) = (A \times B) \cup (A \times C) \\
     (B \cup C) \times A = (B \times A) \cup (C \times A) \\
     A \times (B \cap C) = (A \times B) \cap (A \times C) \\
     (B \cap C) \times A = (B \times A) \cap (C \times A)
     $$

>   **定义 4.4**
>
>   设 $A_1, A_2, \cdots, A_n$ 是集合（$n \ge 2$），其 n 阶笛卡儿积记作 $A_1 \times A_2 \times \cdots \times A_n$，其中：
>   $$
>   A_1 \times \cdots \times A_n = \{<x_1 \cdots, x_n> \mid x \in A_i \and \cdots \and x_n \in A_n\}
>   $$
>   当 $A_1 = A_2 = \cdots = A_n = A$ 时，将其 n 阶笛卡儿积记为 $A^n$。

>   **定义 4.5**
>
>   若一个集合为空集或它的元素都是有序对，则称这个集合是一个**二元关系**，记作 R。对于二元关系 R，若 $<x, y> \in R$，则记作 $xRy$；若 $<x, y> \notin R$，则记作 $x\centernot Ry$。

>   **定义 4.6**
>
>   设 A、B 为集合，$A \times B$ 的任何子集所定义的二元关系称作**从 A 到 B 的二元关系**，当 $A = B$ 时，则称作 **A 上的二元关系**。

通常集合 A 上不同关系的数目依赖于 A 的基数，若 $|A| = n$，则 $|A \times A| = n^2$，$A \times A$ 的子集有 $2^{n^2}$ 个。每一个子集都是一个 A 上的一个关系，但大部分关系都没有什么实际意义，但对任何集合都有 3 种特殊关系：空集称作**空关系**，以及**全域关系** $E_A$ 和**恒等关系** $I_A$。

>   **定义 4.7**
>
>   对任意集合 A：
>   $$
>   E_A = \{<x, y> \mid x \in A \and y \in A\} = A \times A \\
>   I_A = \{<x, x> \mid x \in A\}
>   $$

设 A 为实数集 $\mathbb{R}$ 的某个子集，则 A 上的小于等于关系定义为：
$$
L_A = \{<x, y> \mid x, y \in A \and x \le y\}
$$
设 B 为正整数集 $\mathbb{Z^+}$ 的某个子集，则 B 上的整除关系定义为：
$$
D_B = \{<x, y> \mid x, y \in B \and x | y\}
$$
设 $A = \{x_1, x_2, \cdots, x_n\}$，R 是 A 上的关系，令：
$$
r_{ij} = \begin{cases}
1 & \text{if} \ x_iRx_j \\
0 & \text{if} \ x_i\centernot Rx_j
\end{cases}
$$
则：
$$
(r_{ij}) = \begin{bmatrix}
r_{11} & r_{12} & \cdots & r_{1n} \\
r_{21} & r_{22} & \cdots & r_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
r_{n1} & r_{n2} & \cdots & r_{nn}
\end{bmatrix}
$$
是 R 的**关系矩阵**。

设 V 是顶点的集合，E 是有向边的集合，令 $V = A = \{x_1, x_2, \cdots, x_n\}$，若 $x_iRx_j$，则 $x_i$ 到 $x_j$ 的有向边 $<x_i, x_j> \in E$，那么 $G = <V, E>$​ 就是 R 的**关系图**。

## 4.2 关系的运算

设 S 是 A 到 B 的关系，通常并非所有元素都是 S 的有序对，在研究关系时，通常只关心部分元素。

>   **定义 4.8**
>
>   关系 R 的**定义域** $domR$，**值域** $ranR$ 和**域** $fldR$ 分别为：
>   $$
>   domR = \{x \mid \exist y (<x, y> \in R)\} \\
>   ranR = \{y \mid \exist x (<x, y> \in R)\} \\
>   fldR = domR \cup ranR
>   $$

domR 就是 R 的所有有序对的第一元素构成的集合，ranR 就是第二元素构成的集合。如对于单位圆，domR 和 ranR 都是实数集 $\mathbb R$ 上的一个闭区间 [-1, 1]。

例：

1.   $R_1 = \{<x, y> \mid x, y \in \mathbb Z \and x \le y\}$​
     $$
     domR_1 = ranR_1 = \mathbb Z
     $$

2.   $R_2 = \{<x, y> \mid x, y \in \mathbb Z \and x^2 + y^2 = 1\}$
     $$
     R_2 = \{<0, 1>, <0, -1>, <1, 0>, <-1, 0>\} \\
     domR_2 = ranR_2 = \{0,1,-1\}
     $$

3.   $R_3 = \{<x, y> \mid x, y \in \mathbb Z \and y = 2x\}$
     $$
     domR_3 = \mathbb Z \\
     ranR_3 = \{2z \mid z \in \mathbb Z\}
     $$
     

>   **定义 4.9**
>
>   设 F、G 为任意关系，A 为集合，则
>
>   1.   F 的**逆**记作 $F^{-1}$
>        $$
>        F^{-1} = \{<x, y> \mid yFx\}
>        $$
>
>   2.   F 与 G 的**合成**记作 $F \circ G$
>        $$
>        F \circ G = \{<x, y> \mid \exist z (xGz \and zFy)\}
>        $$
>
>   3.   F 在 A 上的**限制**记作 $F \restriction A$
>        $$
>        F \restriction A = \{<x, y> \mid xFy \and x \in A\}
>        $$
>
>   4.   A 在 F 下的**像**记作 $F[A]$
>        $$
>        F[A] = ran(F \restriction A)
>        $$

关系 R 是有序对的集合，也可以堪称一种作用。如 $<x, y> \in R$ 表示 x 通过 R 的作用变到 y。$R^{-1}$ 就表示 R 的逆作用。$<x, y> \in F \circ G$ 就表示存在一个中间变量 z，x 通过 G 变到 z，再通过 F 变到 y。$F \restriction A$ 描述了 F 对 A 中元素的作用，是 F 的一个子关系。$F[A]$ 描述了 A 在 F 的作用下变成的那个新的集合。对任何关系 F、G 和集合 A，通过逆、合成、限制等运算得到的是一个新的关系，像的运输算结果不一定是关系，而是一个集合。

例：设 F、G 是 N 上的关系，其定义为
$$
F = \{<x, y> \mid x, y \in N \and y = x^2\} \\
G = \{<x, y> \mid x, y \in N \and y = x + 1\}
$$
则
$$
G^{-1} = \{<y, x> \mid y, x \in N \and y = x + 1\} \\
F \circ G = \{<x, y> \mid y, x \in N \and y = (x + 1)^2\} \\
F \restriction \{1,2\} = \{<1,1>, <2,4>\} \\
F[\{1,2\}] = ran(F \restriction \{1,2\}) = \{1, 4\}
$$
可以看出，$F \circ G \ne G \circ F$，因此合成是不可交换的。

>   **定理 4.1**
>
>   设 F、H、G 是任意关系，则有
>
>   1.   $(F^{-1})^{-1} = F$
>   2.   $domF^{-1} = ranF,\ ranF^{-1} = domF$
>   3.   $(F \circ G) \circ H = F \circ (G \circ H)$
>   4.   $(F \circ G)^{-1} = G^{-1} \circ F^{-1}$

>   **定理 4.2**
>
>   设 F、H、G 是任意关系，则有
>
>   1.   $F \circ (G \cup H) = F \circ G \cup F \circ H$
>   2.   $F \circ (G \cap H) \subseteq F \circ G \cap F \circ H$
>   3.   $(G \cup H) \circ F = G \circ F \cup H \circ F$
>   4.   $(G \cap H) \circ F \subseteq G \circ F \cap H \circ F$

>   **定义 4.10**
>
>   设 R 为 A 上的关系，n 为自然数，则 R 的 n 次幂规定为：
>
>   1.   $R^0 = \{<x, x> \mid x \in A\}$
>   2.   $R^n = R^{n-1} \circ R, n \ge 1$

由定义可知，$R^0$ 就是 A 上的恒等关系 $I_A$，因此：
$$
R \circ R^0 = R = R^0 \circ R \\
R^1 = R^0 \circ R = R
$$

>   **定理 4.3**
>
>   设 R 为 A 上的关系，m、n 是自然数，则有：
>
>   1.   $R^m \circ R^n = R^{m+n}$
>   2.   $(R^m)^n = R^{mn}$

## 4.3 关系的性质

